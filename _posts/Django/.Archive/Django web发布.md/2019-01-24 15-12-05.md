---
date: 2018-12-2 20:02
tags: Django
status: public
title: 'Django 发布配置'
---
1、配置nginx
<code>sudo vim /etc/nginx/sites-available/AGAC.conf</code>
<code>sudo ln -s /etc/nginx/sites-available/AGAC.conf /etc/nginx/sites-enabled/AGAC.conf</code>
```
server {
    listen      8000;
    server_name 主机ip;
    charset     utf-8;

    client_max_body_size 75M;
    access_log /home/admin/AGAC_web/AGAC/nginx/acc_log;
    error_log  /home/admin/AGAC_web/AGAC/nginx/error_log;
    location /static {
        alias /home/admin/AGAC_web/AGAC/static;
    }
    location / {
        uwsgi_pass  127.0.0.1:8899;
        include     /etc/nginx/uwsgi_params;
    }
}
```
1、配置uwsgi
在项目目录中新建uwsgi.ini
```
[uwsgi]
socket= 127.0.0.1:8899
chdir = /home/admin/AGAC_web/AGAC
wsgi-file = AGAC/wsgi.py
processes = 2
threads = 4
module=AGAC.wsgi
#chmod-socket = 664
#chown-socket = tu:www-data
vacuum = true
daemonize = UWSGI.log
stats=%(chdir)/uwsgi/uwsgi.status
pidfile=%(chdir)/uwsgi/uwsgi.pid
```

3、静态文件

参考：https://blog.csdn.net/mr_oldcold/article/details/79833044
https://segmentfault.com/q/1010000002523354





1、本地先配置好
2、配置uwsgi.ini
```
# uwsgi.ini file
[uwsgi]
# Django-related settings
#直接对外
http-socket = :8000
#内部调用
socket = :8001
# the base directory (full path)
chdir = /www/wwwroot/AGAC_KGQA_PART
# Django s wsgi file
wsgi-file = AGAC_KGQA/wsgi.py
#module = AGAC_KGQA.wsgi
# process-related settings
# master
master = true
# maximum number of worker processes
processes = 4
# ... with appropriate permissions - may be needed
# chmod-socket = 664
# clear environment on exit
vacuum = true
daemonize = /var/log/uwsgi.log
```
3、uwsgi --ini uwsgi.ini
此时可以通过公网ip：8000访问服务器
4、安装宝塔
```
wget -O install.sh http://download.bt.cn/install/install-ubuntu.sh && sudo bash install.sh
```
5、更改 nginx 配置文件以用于应用程序
在项目主目录下创建nginx.conf文件
```
vim /etc/nginx/nginx.conf
vim /etc/nginx/conf.d/*.conf
server {
      listen         80;
      server_name    localhost
      charset UTF-8;
      access_log      /www/wwwlogs/project_access.log;
      error_log       /www/wwwlogs/project_error.log;

      client_max_body_size 75M;

      location / {
             include uwsgi_params;
             uwsgi_pass :8000;
             uwsgi_read_timeout 2;
       }
       location /static {
            expires 30d;
            autoindex on;
            add_header Cache-Control private;
            alias /www/wwwroot/AGAC_KGQA_PART/static/;
         }
}

```

kyzhou@ubuntu:~$ /etc/init.d/nginx start  #启动
kyzhou@ubuntu:~$ /etc/init.d/nginx stop  #关闭
kyzhou@ubuntu:~$ /etc/init.d/nginx restart  #重启
6、重启 nginx，随后您的应用程序将启动并在端口 80 上的 nginx 之后运行。













